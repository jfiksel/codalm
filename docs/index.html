<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transformation-free Linear Regression for Compositional Outcomes and Predictors • codalm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Transformation-free Linear Regression for Compositional Outcomes and Predictors">
<meta property="og:description" content="Implements the EM algorithm as described in Fiksel et al. (2020)
    for transformation-free linear regression for
    compositional outcomes and predictors.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">codalm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/codalm_quickstart.html">How to use codalm</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jfiksel/codalm/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="the-codalm-r-package" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#the-codalm-r-package" class="anchor"></a>The codalm R package</h1></div>
<p>The codalm R package implements the methods as described in <a href="https://arxiv.org/abs/2004.07881">A Transformation-free Linear Regression for Compositional Outcomes and Predictors</a> (Fiksel, Zeger, and Datta, 2020)</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the current version of codalm for github using the <code>remotes</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"jfiksel/codalm"</span>)</pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>We will start by loading the <code>codalm</code> R package, as well as the <code>ggtern</code> package, which we will use to access the data.</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">codalm</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggtern</span>)</pre></div>
<p>We will now load in the data from the ggtern package. We will be analyzing how two different methods (image analysis or microscopic inspection) estimate the composition of 30 white blood cells. The format that we need is for both compositions to be in matrices, with one row per observation. We will also normalize the rows of these matrices to ensure that they sum to 1, although the <code>codalm</code> function would also take care of this for us.</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"WhiteCells"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">'ggtern'</span>)
<span class="no">image</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">WhiteCells</span>, <span class="no">Experiment</span> <span class="kw">==</span> <span class="st">"ImageAnalysis"</span>)
<span class="no">image_mat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">image</span>[,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"G"</span>, <span class="st">"L"</span>, <span class="st">"M"</span>)])
<span class="no">microscopic</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">WhiteCells</span>, <span class="no">Experiment</span> <span class="kw">==</span> <span class="st">"MicroscopicInspection"</span>)
<span class="no">microscopic_mat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">microscopic</span>[,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"G"</span>, <span class="st">"L"</span>, <span class="st">"M"</span>)])

<span class="no">image_mat</span>  <span class="kw">&lt;-</span> <span class="no">image_mat</span>  / <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(<span class="no">image_mat</span>)
<span class="no">microscopic_mat</span> <span class="kw">&lt;-</span> <span class="no">microscopic_mat</span> / <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(<span class="no">microscopic_mat</span>)</pre></div>
<p>To estimate the coefficient matrix B, we can use the <code>codalm</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="no">B_est</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/codalm.html">codalm</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">microscopic_mat</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="no">image_mat</span>)
<span class="no">B_est</span></pre></div>
<p>We can also use the bootstrap to estimate 95% confidence intervals. We will only use 50 bootstrap iterations as an example (R = 50), but is recommended to do more.</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="no">B_ci</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/codalm_ci.html">codalm_ci</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">microscopic_mat</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="no">image_mat</span>, <span class="kw">nboot</span> <span class="kw">=</span> <span class="fl">50</span>, <span class="kw">ci_type</span> <span class="kw">=</span> <span class="st">"perc"</span>,
                   <span class="kw">conf</span> <span class="kw">=</span> <span class="fl">.95</span>)
<span class="no">B_ci</span>$<span class="no">ci_L</span>
<span class="no">B_ci</span>$<span class="no">ci_U</span></pre></div>
<p>You can also take advantage of parallelization, if you have multiple cores available. Note that the code below will likely not work for Windows users–please see the documentation for <code>boot</code> to see how one would parallelize for a Windows OS. Note that the number of cores is not required to be 4.</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="no">ncores</span> <span class="kw">&lt;-</span> <span class="fl">4</span>
<span class="no">B_ci</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/codalm_ci.html">codalm_ci</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">microscopic_mat</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="no">image_mat</span>, <span class="kw">nboot</span> <span class="kw">=</span> <span class="fl">50</span>, <span class="kw">ci_type</span> <span class="kw">=</span> <span class="st">"perc"</span>,
                   <span class="kw">conf</span> <span class="kw">=</span> <span class="fl">.95</span>, <span class="kw">parallel</span> <span class="kw">=</span> <span class="st">"multicore"</span>, <span class="kw">ncpus</span> <span class="kw">=</span> <span class="no">ncores</span>)</pre></div>
<p>Finally, we will do a permutation test for linear independence. Again, we will only do 50 permutations as an example, but in practice this number should be higher.</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="no">indep_test_pval</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/codalm_indep_test.html">codalm_indep_test</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">microscopic_mat</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="no">image_mat</span>,
                                     <span class="kw">nperms</span> <span class="kw">=</span> <span class="fl">50</span>, <span class="kw">init.seed</span> <span class="kw">=</span> <span class="fl">123</span>)
<span class="no">indep_test_pval</span></pre></div>
<p>For those without a Windows OS, this function can be parallelized as follows:</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="no">ncores</span> <span class="kw">&lt;-</span> <span class="fl">4</span>
<span class="no">indep_test_pval</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/codalm_indep_test.html">codalm_indep_test</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">microscopic_mat</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="no">image_mat</span>,
                                     <span class="kw">nperms</span> <span class="kw">=</span> <span class="fl">50</span>, <span class="kw">init.seed</span> <span class="kw">=</span> <span class="fl">123</span>,
                                     <span class="kw">parallel</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">ncpus</span> <span class="kw">=</span> <span class="no">ncores</span>)</pre></div>
<p>And for those with a Windows OS:</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="no">ncores</span> <span class="kw">&lt;-</span> <span class="fl">4</span>
<span class="no">indep_test_pval</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/codalm_indep_test.html">codalm_indep_test</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">microscopic_mat</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="no">image_mat</span>,
                                     <span class="kw">nperms</span> <span class="kw">=</span> <span class="fl">50</span>, <span class="kw">init.seed</span> <span class="kw">=</span> <span class="fl">123</span>,
                                     <span class="kw">parallel</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">ncpus</span> <span class="kw">=</span> <span class="no">ncores</span>, <span class="kw">windowsOS</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/jfiksel/codalm/">https://​github.com/​jfiksel/​codalm/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/jfiksel/codalm/issues">https://​github.com/​jfiksel/​codalm/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Jacob Fiksel <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Jacob Fiksel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
